version: 2

models:
    - name: stg_redshift_public__hospital_admits
      description: >
        Represents when a patient has been admitted to the hospital for inpatient care
      tests:
        - dbt_utils.unique_combination_of_columns:
            combination_of_columns:
              - admit_event_id
              - patient_id
      columns:
          - name: admit_event_id
            description: >
              the primary key for a row in the admits table
            tests:
                - not_null

          - name: patient_id
            description: >
              company generated unique patient_id
            tests:
                - not_null

          - name: admit_date
            description: >
              admit date for patient recorded in UTC
            tests:
                - not_null

          - name: admit_date_est
            description: >
              admit date converted to eastern standard time to align with company systems if needed

          - name: event_type
            description: >
              event type provided in adt feed

          - name: logical_event_type
            description: >
              field created by company logic to roll up event types provided in adt feed to single category

          - name: institution_id
            description: >
              id created by company to link information to specific customer

          - name: chf_flag
            description: >
              flag indicating diagnosis for congestive heart failure recorded on admit

          - name: diabetes_flag
            description: >
              flag indicating diagnosis for diabetes recorded on admit

          - name: copd_flag
            description: >
              flag indicating diagnosis for chronic obstructive pulmonary disease recorded on admit

          - name: pna_flag
            description: >
              flag indicating diagnosis for pneumonia recorded on admit

          - name: ami_flag
            description: >
              flag indicating diagnosis for acute myocardial infarction recorded on admit

          - name: sepsis_flag
            description: >
              flag indicating diagnosis for sepsis recorded on admit
